#! /bin/sh

if [ $# -lt 1 ]; then
    exit 1
fi

case "$1" in
    i3|bspwm)
        X=1
        cmd="startx $@" ;;

    *)
        echo "Undefined WM" 1>&2
        exit 1
        ;;
esac

eval "$cmd" &
pid=$!

if [ "$X" -eq 1 ]; then
    DISPLAY="$(ls /tmp/.X11-unix/ | tr 'X' ':' | tail -1)"
    export DISPLAY
fi

(sleep 1; wmrc) &

wait $pid
